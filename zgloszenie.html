<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Świadczenia – formularz</title>

<style>
body {
  font-family: 'Segoe UI', Tahoma, sans-serif;
  background: #f3e5e5;
  margin: 0;
  padding: 20px;
  display: flex;
  justify-content: center;
}

.container {
  background: #fff;
  max-width: 700px;
  width: 100%;
  padding: 30px;
  border-radius: 12px;
  box-shadow: 0 6px 18px rgba(0,0,0,.15);
}

h2 {
  text-align: center;
  color: #8b0000;
  margin-top: 0;
}

.step {
  margin-top: 25px;
  padding: 20px;
  border-radius: 10px;
  background: #fdeeee;
  border: 1px solid #e3bcbc;
}

.step h3 {
  margin-top: 0;
  color: #7a0000;
}

.field {
  margin-bottom: 12px;
}

label {
  font-weight: 600;
  font-size: 0.8rem;
  display: block;
  margin-bottom: 4px;
}

input, select, textarea {
  width: 100%;
  padding: 7px 10px;
  border-radius: 6px;
  border: 1.4px solid #caa;
  font-size: 0.9rem;
}

.copy-btn {
  margin-top: 4px;
  background: #8b0000;
  color: #fff;
  border: none;
  padding: 4px 10px;
  border-radius: 5px;
  font-size: 0.72rem;
  cursor: pointer;
}

.copy-btn:hover { background: #a40000; }

.hidden { display: none; }

.note {
  font-size: 0.75rem;
  color: #555;
  margin-top: 4px;
}

.grid2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}
</style>
</head>

<body>
<div class="container">
<h2>Świadczenia – formularz</h2>

<!-- KROK 1 -->
<div class="step">
<h3>Krok 1: Kto zgłasza</h3>
<select id="kto">
  <option value="">-- wybierz --</option>
  <option value="a">Osoba trzecia</option>
  <option value="b">Upoważniona osoba trzecia</option>
  <option value="c">Osoba obsługująca / AZP</option>
  <option value="d">Uprawniony</option>
</select>
</div>

<!-- KROK 2 -->
<div id="step2" class="step hidden">
<h3>Krok 2: Dane zgłaszającego</h3>

<div class="field"><label>Imię</label><input><button class="copy-btn">Kopiuj</button></div>
<div class="field"><label>Nazwisko</label><input><button class="copy-btn">Kopiuj</button></div>

<div class="field"><label>PESEL</label><input class="pesel"><button class="copy-btn">Kopiuj</button></div>
<div class="field"><label>Data urodzenia</label><input type="date" class="dob"><button class="copy-btn">Kopiuj</button></div>

<div class="field"><label>Płeć</label><input><button class="copy-btn">Kopiuj</button></div>
<div class="field"><label>Kraj urodzenia</label><input><button class="copy-btn">Kopiuj</button></div>
<div class="field"><label>Nr telefonu</label><input><button class="copy-btn">Kopiuj</button></div>

<div id="upowaznienie" class="field hidden">
  <label>Upoważnienie ustne</label>
  <textarea id="upText" rows="2"></textarea>
  <button class="copy-btn" onclick="copyUp()">Upoważnienie</button>
  <div class="note">Wklej w opisie zgłoszenia</div>
</div>
</div>

<!-- KROK 3 -->
<div id="step3" class="step hidden">
<h3>Krok 3: Dane uprawnionego</h3>

<div class="field"><label>Imię</label><input><button class="copy-btn">Kopiuj</button></div>
<div class="field"><label>Nazwisko</label><input><button class="copy-btn">Kopiuj</button></div>

<div class="field"><label>PESEL</label><input class="pesel"><button class="copy-btn">Kopiuj</button></div>
<div class="field"><label>Data urodzenia</label><input type="date" class="dob"><button class="copy-btn">Kopiuj</button></div>

<!-- ADRES ZAMIESZKANIA -->
<h4>Adres zamieszkania</h4>
<div class="grid2">
  <div class="field"><label>Ulica</label><input id="az_ulica"><button class="copy-btn">Kopiuj</button></div>
  <div class="field"><label>Nr domu</label><input id="az_dom"><button class="copy-btn">Kopiuj</button></div>
  <div class="field"><label>Nr mieszkania</label><input id="az_miesz"><button class="copy-btn">Kopiuj</button></div>
  <div class="field"><label>Kod pocztowy</label><input id="az_kod"><button class="copy-btn">Kopiuj</button></div>
</div>
<div class="field"><label>Miejscowość</label><input id="az_miasto"><button class="copy-btn">Kopiuj</button></div>

<!-- ADRES KORESPONDENCYJNY -->
<h4>Adres korespondencyjny</h4>
<div class="grid2">
  <div class="field"><label>Ulica</label><input id="ak_ulica"><button class="copy-btn">Kopiuj</button></div>
  <div class="field"><label>Nr domu</label><input id="ak_dom"><button class="copy-btn">Kopiuj</button></div>
  <div class="field"><label>Nr mieszkania</label><input id="ak_miesz"><button class="copy-btn">Kopiuj</button></div>
  <div class="field"><label>Kod pocztowy</label><input id="ak_kod"><button class="copy-btn">Kopiuj</button></div>
</div>
<div class="field"><label>Miejscowość</label><input id="ak_miasto"><button class="copy-btn">Kopiuj</button></div>

<button class="copy-btn" onclick="copyAddrAll()">Adres korespondencyjny taki sam</button>

<h4>Dane kontaktowe</h4>
<div class="field">
  <label>Email</label>
  <input>
  <div style="display:flex; gap:6px;">
    <button class="copy-btn">Kopiuj</button>
    <a href="https://gabrielkorzeniowski.github.io/zycie/LITEROWANIE.html"
       target="_blank"
       class="copy-btn"
       style="text-decoration:none; display:inline-flex; align-items:center;">
       Literuj
    </a>
  </div>
</div>


<div class="field">
  <label>Numer rachunku</label>
  <input id="iban">
  <button class="copy-btn" id="ibanCopy">Kopiuj</button>
</div>

</div>
</div>

<script>
// KROKI
const kto = document.getElementById('kto');
const step2 = document.getElementById('step2');
const step3 = document.getElementById('step3');
const up = document.getElementById('upowaznienie');

kto.addEventListener('change', () => {
  step2.classList.add('hidden');
  step3.classList.add('hidden');
  up.classList.add('hidden');

  if (!kto.value) return;

  if (kto.value !== 'd') step2.classList.remove('hidden');
  step3.classList.remove('hidden');
  if (kto.value === 'b') up.classList.remove('hidden');
});

// KOPIOWANIE PÓL
document.querySelectorAll('.copy-btn').forEach(btn => {
  btn.addEventListener('click', e => {
    const input = e.target.previousElementSibling;
    if (input && input.value !== undefined) {
      navigator.clipboard.writeText(input.value);
    }
  });
});

// UPOWAŻNIENIE
function copyUp() {
  const txt = "Uprawniony upoważnił osobę zgłaszającą podczas rozmowy.";
  document.getElementById('upText').value = txt;
  navigator.clipboard.writeText(txt);
}

// ADRES – KOPIOWANIE WSZYSTKIEGO
function copyAddrAll() {
  ak_ulica.value = az_ulica.value;
  ak_dom.value = az_dom.value;
  ak_miesz.value = az_miesz.value;
  ak_kod.value = az_kod.value;
  ak_miasto.value = az_miasto.value;
}

// PESEL → DATA
document.querySelectorAll('.pesel').forEach(p => {
  p.addEventListener('input', () => {
    const dob = p.closest('.step').querySelector('.dob');
    if (validatePesel(p.value)) {
      dob.value = peselToDate(p.value);
    }
  });
});

function validatePesel(p) {
  if (!/^\d{11}$/.test(p)) return false;
  const w = [1,3,7,9,1,3,7,9,1,3];
  let s = 0;
  for (let i=0;i<10;i++) s += w[i]*p[i];
  return (10 - (s % 10)) % 10 === +p[10];
}

function peselToDate(p) {
  let y = p.slice(0,2), m = p.slice(2,4), d = p.slice(4,6);
  let year = m > 20 ? '20'+y : '19'+y;
  m = m > 20 ? m-20 : m;
  return `${year}-${String(m).padStart(2,'0')}-${d}`;
}

// RACHUNEK BANKOWY
const iban = document.getElementById('iban');
const ibanCopy = document.getElementById('ibanCopy');

iban.addEventListener('input', () => {
  let v = iban.value.replace(/\D/g,'').slice(0,26);
  iban.value = v.replace(/(\d{2})(\d{4})(\d{4})(\d{4})(\d{4})(\d{4})/,'$1 $2 $3 $4 $5 $6');
});

ibanCopy.addEventListener('click', () => {
  const raw = iban.value.replace(/\s/g,'');
  if (raw.length === 26) {
    navigator.clipboard.writeText(raw);
  }
});
</script>

</body>
</html>
