<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>Workflow WDCiR</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #e6f2e6; /* pasujący zielony styl */
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding: 40px;
  }

  .workflow-container {
    background: #ffffff;
    padding: 30px 40px;
    border-radius: 12px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.12);
    width: 500px;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  h1 {
    text-align: center;
    color: #2b662b;
  }

  label {
    font-weight: bold;
  }

  input, select, button {
    padding: 10px;
    font-size: 16px;
    margin-top: 5px;
    border-radius: 6px;
    border: 1px solid #2b662b;
    width: 100%;
  }

  button {
    background-color: #2b662b;
    color: white;
    cursor: pointer;
    margin-top: 10px;
  }

  button:hover {
    background-color: #1e4d1e;
  }

  .hidden {
    display: none;
  }

  #finalBox {
    background: #f0fff0;
    border: 1px solid #2b662b;
    padding: 15px;
    border-radius: 8px;
  }
</style>
</head>
<body>
<div class="workflow-container">
  <h1>Workflow WDCiR</h1>

  <!-- KROK 1: DATA -->
  <div id="step1">
    <label>Data zawarcia umowy (dd.mm.rrrr):</label>
    <input type="text" id="contractDate" placeholder="dd.mm.rrrr">
    <button onclick="checkWDCiR()">Ok</button>
  </div>

  <!-- KROK 2: WERSJA WDCiR -->
  <div id="step2" class="hidden">
    <p>Wersja WDCiR: <span id="wdcirVersion"></span></p>
    <label>Wybierz wariant:</label>
    <select id="variantSelect" onchange="showNextStep()">
      <!-- opcje będą generowane dynamicznie -->
    </select>
  </div>

  <!-- KROK 3: OSTATECZNE ROZWIĄZANIE -->
  <div id="step3" class="hidden">
    <p>Wariant szczegółowy:</p>
    <select id="finalSelect" onchange="finalDecision(this.value)">
      <!-- opcje dynamiczne -->
    </select>
  </div>

  <div id="finalBox" class="hidden">
    <!-- Tutaj pojawi się końcowe rozwiązanie -->
  </div>
</div>

<script>
function parseDate(input) {
  const parts = input.split('.');
  if(parts.length !== 3) return null;
  return new Date(parts[2], parts[1]-1, parts[0]);
}

function checkWDCiR() {
  const dateInput = document.getElementById('contractDate').value;
  const date = parseDate(dateInput);
  if(!date) { alert('Niepoprawny format daty!'); return; }

  const wdcirSpan = document.getElementById('wdcirVersion');
  let version = '';
  let variants = [];

  if(date >= new Date(2024,3,14)) { // po 14.04.2024
    version = 'WDCiR 5.0';
    variants = ['Zachowanie składki / obniżenie SU', 'Zachowanie SU / podwyższenie składki'];
  } else if(date >= new Date(2023,1,19) && date <= new Date(2024,3,13)) {
    version = 'WDCiR 4.5';
    variants = ['Jest pismo', 'Nie ma pisma'];
  } else if(date >= new Date(2022,0,30) && date <= new Date(2023,1,18)) {
    version = 'WDCiR 4.0';
    variants = ['Zachowanie składki / obniżenie SU (4.0)', 'Zachowanie SU / podwyższenie składki (4.0)'];
  } else if(date >= new Date(2020,8,1) && date <= new Date(2022,0,29)) {
    version = 'WDCiR 3.0';
    variants = ['Adekwatność'];
  } else if(date >= new Date(2017,5,14) && date <= new Date(2020,7,31)) {
    version = 'WDCiR 2.0';
    variants = ['Adekwatność'];
  } else {
    version = 'WDCiR 1.0';
    variants = ['N/A'];
  }

  wdcirSpan.textContent = version;

  const variantSelect = document.getElementById('variantSelect');
  variantSelect.innerHTML = '<option value="">-- wybierz --</option>';
  variants.forEach(v => {
    const opt = document.createElement('option');
    opt.value = v;
    opt.textContent = v;
    variantSelect.appendChild(opt);
  });

  document.getElementById('step2').classList.remove('hidden');
  document.getElementById('step3').classList.add('hidden');
  document.getElementById('finalBox').classList.add('hidden');
}

function showNextStep() {
  const variant = document.getElementById('variantSelect').value;
  const finalSelect = document.getElementById('finalSelect');
  finalSelect.innerHTML = '<option value="">-- wybierz --</option>';

  if(!variant) { document.getElementById('step3').classList.add('hidden'); return; }

  // Warianty końcowe
  let options = [];
  if(variant === 'Jest pismo' || variant === 'Nie ma pisma') {
    options = ['Zachowanie składki / obniżenie SU (4.5)', 'Zachowanie SU / podwyższenie składki (4.5)'];
  } else {
    options = [variant];
  }

  options.forEach(o => {
    const opt = document.createElement('option');
    opt.value = o;
    opt.textContent = o;
    finalSelect.appendChild(opt);
  });

  document.getElementById('step3').classList.remove('hidden');
  document.getElementById('finalBox').classList.add('hidden');
}

function finalDecision(text) {
  const finalBox = document.getElementById("finalBox");
  finalBox.style.display = "block";

  let solution = "";

  // WDCiR 5.0
  if (text === 'Zachowanie składki / obniżenie SU') {
      solution = "ROZWIĄZANIE dla WDCiR 5.0 - Zachowanie składki / obniżenie SU";
      // <-- TU WPISZ KONKRETNE ROZWIĄZANIE
  } 
  else if (text === 'Zachowanie SU / podwyższenie składki') {
      solution = "ROZWIĄZANIE dla WDCiR 5.0 - Zachowanie SU / podwyższenie składki";
      // <-- TU WPISZ KONKRETNE ROZWIĄZANIE
  }

  // WDCiR 4.0
  else if (text === 'Zachowanie składki / obniżenie SU (4.0)') {
      solution = "ROZWIĄZANIE dla WDCiR 4.0 - Zachowanie składki / obniżenie SU";
      // <-- TU WPISZ KONKRETNE ROZWIĄZANIE
  } 
  else if (text === 'Zachowanie SU / podwyższenie składki (4.0)') {
      solution = "ROZWIĄZANIE dla WDCiR 4.0 - Zachowanie SU / podwyższenie składki";
      // <-- TU WPISZ KONKRETNE ROZWIĄZANIE
  }

  // WDCiR 4.5
  else if (text === 'Zachowanie składki / obniżenie SU (4.5)') {
      solution = "ROZWIĄZANIE dla WDCiR 4.5 - Zachowanie składki / obniżenie SU";
      // <-- TU WPISZ KONKRETNE ROZWIĄZANIE
  } 
  else if (text === 'Zachowanie SU / podwyższenie składki (4.5)') {
      solution = "ROZWIĄZANIE dla WDCiR 4.5 - Zachowanie SU / podwyższenie składki";
      // <-- TU WPISZ KONKRETNE ROZWIĄZANIE
  }

  // WDCiR 3.0 i 2.0 i 1.0
  else if (text === 'Adekwatność') {
      solution = "ROZWIĄZANIE dla WDCiR 3.0 / 2.0 - Adekwatność";
      // <-- TU WPISZ KONKRETNE ROZWIĄZANIE
  } 
  else if (text === 'N/A') {
      solution = "ROZWIĄZANIE dla WDCiR 1.0 - brak opcji";
      // <-- TU WPISZ KONKRETNE ROZWIĄZANIE
  }

  finalBox.innerHTML = `
      <h3>Wybrany wariant:</h3>
      <p><b>${text}</b></p>
      <p>${solution}</p>
  `;
}
</script>
</body>
</html>